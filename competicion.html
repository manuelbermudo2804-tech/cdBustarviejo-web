<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Competición - C.D. Bustarviejo</title>
<link href__="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href__="css/styles.css">
<style>
.contenedor-competicion {
  max-width: 1200px;
  margin: 70px auto;
  padding: 0 20px;
}
.bloque {
  background: white;
  padding: 35px;
  margin-bottom: 50px;
  border-radius: 14px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.06);
}
.bloque h2 {
  font-size: 24px;
  margin-bottom: 25px;
  color: #0b3d91;
  border-left: 5px solid #0b3d91;
  padding-left: 12px;
}
.bloque h3 {
  font-size: 18px;
  margin: 20px 0 10px;
  color: #333;
}
table {
  width: 100%;
  border-collapse: collapse;
  margin-top: 10px;
  margin-bottom: 30px;
  font-size: 14px;
}
th {
  background: #0b3d91;
  color: white;
  padding: 10px;
  font-size: 12px;
  text-transform: uppercase;
}
td {
  padding: 8px;
  border-bottom: 1px solid #eee;
  text-align: center;
}
td:nth-child(2) {
  text-align: left;
}
tr:hover {
  background: #f5f8ff;
}
.club-propio {
  background: #e6f0ff !important;
  font-weight: 600;
}
.cargando {
  text-align: center;
  padding: 40px;
  color: #999;
  font-size: 16px;
}
</style>
</head>
<body>

<header class="header">
  <div class="header-contenido">
    <div class="logo">
      <img src="img/escudo.png" alt="Escudo">
      <span>C.D. Bustarviejo</span>
    </div>
    <button class="menu-toggle">☰</button>
    <nav class="menu">
      <a href__="index.html">Inicio</a>
      <a href__="el-club.html">El Club</a>
      <a href__="equipos.html">Equipos</a>
      <a href__="patrocinadores.html">Patrocinadores</a>
      <a href__="tienda.html">Tienda</a>
      <a href__="comunicados.html">Comunicados</a>
      <a href__="competicion.html">Competición</a>
      <a href__="area-interna.html">Área interna</a>
    </nav>
  </div>
</header>

<section class="contenedor-competicion">
  <div class="bloque" id="clasificacion">
    <h2>Clasificación</h2>
    <p class="cargando">Cargando clasificaciones...</p>
  </div>
  <div class="bloque" id="goleadores">
    <h2>Goleadores C.D. Bustarviejo</h2>
    <p class="cargando">Cargando goleadores...</p>
  </div>
</section>

<script>
document.querySelector('.menu-toggle').addEventListener('click', function() {
  document.querySelector('.menu').classList.toggle('activo');
});

async function cargarDatos() {
  try {
    var url = "https://base44.app/api/apps/6992c6be619d2da592897991/functions/publicData";
    var response = await fetch(url);
    var data = await response.json();
    pintarClasificacion(data.clasificaciones);
    pintarGoleadores(data.goleadores);
  } catch (e) {
    document.getElementById("clasificacion").innerHTML = "<h2>Clasificación</h2><p>Error al cargar datos.</p>";
    document.getElementById("goleadores").innerHTML = "<h2>Goleadores</h2><p>Error al cargar datos.</p>";
  }
}

function pintarClasificacion(obj) {
  var cont = document.getElementById("clasificacion");
  if (!obj) {
    cont.innerHTML = "<h2>Clasificación</h2><p>No hay datos disponibles.</p>";
    return;
  }
  var html = "<h2>Clasificación</h2>";
  for (var cat in obj) {
    html += "<h3>" + cat + "</h3>";
    html += "<table>";
    html += "<tr><th>#</th><th>Equipo</th><th>PJ</th><th>G</th><th>E</th><th>P</th><th>GF</th><th>GC</th><th>DG</th><th>Pts</th></tr>";
    for (var i = 0; i < obj[cat].length; i++) {
      var eq = obj[cat][i];
      var esNuestro = eq.equipo.toLowerCase().indexOf("bustarviejo") >= 0;
      var dg = eq.gf - eq.gc;
      html += "<tr class='" + (esNuestro ? "club-propio" : "") + "'>";
      html += "<td>" + eq.posicion + "</td>";
      html += "<td>" + eq.equipo + "</td>";
      html += "<td>" + eq.pj + "</td>";
      html += "<td>" + eq.pg + "</td>";
      html += "<td>" + eq.pe + "</td>";
      html += "<td>" + eq.pp + "</td>";
      html += "<td>" + eq.gf + "</td>";
      html += "<td>" + eq.gc + "</td>";
      html += "<td>" + (dg >= 0 ? "+" : "") + dg + "</td>";
      html += "<td><strong>" + eq.puntos + "</strong></td>";
      html += "</tr>";
    }
    html += "</table>";
  }
  cont.innerHTML = html;
}

function pintarGoleadores(obj) {
  var cont = document.getElementById("goleadores");
  if (!obj) {
    cont.innerHTML = "<h2>Goleadores C.D. Bustarviejo</h2><p>No hay datos disponibles.</p>";
    return;
  }
  var html = "<h2>Goleadores C.D. Bustarviejo</h2>";
  var hay = false;
  for (var cat in obj) {
    var jugadores = obj[cat].slice().sort(function(a, b) { return b.goles - a.goles; });
    if (jugadores.length === 0) continue;
    hay = true;
    html += "<h3>" + cat + "</h3>";
    html += "<table>";
    html += "<tr><th>#</th><th>Jugador</th><th>Goles</th></tr>";
    for (var i = 0; i < jugadores.length; i++) {
      var j = jugadores[i];
      html += "<tr>";
      html += "<td>" + (i + 1) + "</td>";
      html += "<td style='text-align:left'>" + j.jugador + "</td>";
      html += "<td><strong>" + j.goles + "</strong></td>";
      html += "</tr>";
    }
    html += "</table>";
  }
  if (!hay) {
    html += "<p>No hay goleadores registrados.</p>";
  }
  cont.innerHTML = html;
}

cargarDatos();
</script>

</body>
</html>
